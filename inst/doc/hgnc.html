<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Zhuoer Dong" />

<meta name="date" content="2018-07-15" />

<title>Introduction to hgnc</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Introduction to hgnc</h1>
<h4 class="author"><em>Zhuoer Dong</em></h4>
<h4 class="date"><em>2018-07-15</em></h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(hgnc)</a></code></pre></div>
<div id="quick-start" class="section level1">
<h1>quick start</h1>
<p>For impatient people, you can convert a probe-ensembl map like the following <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">probe2ensembl</a></code></pre></div>
<pre><code># A tibble: 10 x 2
   ID          Ensembl                                                
   &lt;chr&gt;       &lt;chr&gt;                                                  
 1 200064_at   ENSG00000096384                                        
 2 200066_at   ENSG00000113141                                        
 3 200068_s_at ENSG00000127022                                        
 4 200069_at   ENSG00000075856                                        
 5 200071_at   ENSG00000119953                                        
 6 200076_s_at ENSG00000105700                                        
 7 200077_s_at ENSG00000104904                                        
 8 200078_s_at ENSG00000117410                                        
 9 200082_s_at ENSG00000171863 /// ENSG00000183405 /// ENSG00000213326
10 200084_at   ENSG00000110696                                        </code></pre>
<p>to a probe-symbol map <a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">probe2ensembl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">melt_map</span>(<span class="st">'ID'</span>, <span class="st">'Ensembl'</span>, <span class="st">' /// '</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">'symbol'</span> =<span class="st"> </span><span class="kw">as_symbol_from_ensembl</span>(Ensembl)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">    </span><span class="kw">cast_map</span>(<span class="st">'ID'</span>, <span class="st">'symbol'</span>, <span class="st">' /// '</span>)</a></code></pre></div>
<pre><code># A tibble: 10 x 2
   ID          symbol          
   &lt;chr&gt;       &lt;chr&gt;           
 1 200064_at   HSP90AB1        
 2 200066_at   IK              
 3 200068_s_at CANX            
 4 200069_at   SART3           
 5 200071_at   SMNDC1          
 6 200076_s_at KXD1            
 7 200077_s_at OAZ1            
 8 200078_s_at ATP6V0B         
 9 200082_s_at RPS7 /// RPS7P11
10 200084_at   C11orf58        </code></pre>
<p>Other common ID like entrez gene ID, Unigene ID, RefSeq accession are also supported.</p>
</div>
<div id="innovation" class="section level1">
<h1>innovation</h1>
<div id="the-problem" class="section level2">
<h2>the problem</h2>
<p>To master this package, you need to understand the problem it aims to solve. That is, to turn something like</p>
<table>
<thead>
<tr class="header">
<th align="left">probe</th>
<th align="left">id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">probe1</td>
<td align="left">id1 | id2</td>
</tr>
<tr class="even">
<td align="left">probe2</td>
<td align="left">id3</td>
</tr>
</tbody>
</table>
<p>to</p>
<table>
<thead>
<tr class="header">
<th align="left">probe</th>
<th align="left">symbol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">probe1</td>
<td align="left">symbol1 | symbol2</td>
</tr>
<tr class="even">
<td align="left">probe2</td>
<td align="left">symbol3</td>
</tr>
</tbody>
</table>
</div>
<div id="solve-a-simpler-one" class="section level2">
<h2>solve a simpler one</h2>
<p>To point out the key difficulty, let’s contrast it with a simpler one — to turn something like</p>
<table>
<thead>
<tr class="header">
<th align="left">probe</th>
<th align="left">id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">probe4</td>
<td align="left">id4</td>
</tr>
<tr class="even">
<td align="left">probe5</td>
<td align="left">id5</td>
</tr>
<tr class="odd">
<td align="left">probe6</td>
<td align="left">id6</td>
</tr>
</tbody>
</table>
<p>to</p>
<table>
<thead>
<tr class="header">
<th align="left">probe</th>
<th align="left">symbol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">probe4</td>
<td align="left">symbol4</td>
</tr>
<tr class="even">
<td align="left">probe5</td>
<td align="left">symbol5</td>
</tr>
<tr class="odd">
<td align="left">probe6</td>
<td align="left">symbol6</td>
</tr>
</tbody>
</table>
<p>That’s quite easy, you just need a id-symbol map</p>
<table>
<caption>id2symbol</caption>
<thead>
<tr class="header">
<th align="left">id</th>
<th align="left">symbol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">id4</td>
<td align="left">symbol4</td>
</tr>
<tr class="even">
<td align="left">id5</td>
<td align="left">symbol5</td>
</tr>
<tr class="odd">
<td align="left">id6</td>
<td align="left">symbol6</td>
</tr>
</tbody>
</table>
<p>and use the following code <a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">probe2id &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tribble</span>(  </a>
<a class="sourceLine" id="cb11-2" data-line-number="2">    <span class="op">~</span>probe, <span class="op">~</span>id,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">    <span class="st">'probe4'</span>, <span class="st">'id4'</span>,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">    <span class="st">'probe5'</span>, <span class="st">'id5'</span>,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">    <span class="st">'probe6'</span>, <span class="st">'id6'</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7"></a>
<a class="sourceLine" id="cb11-8" data-line-number="8">id2symbol &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tribble</span>(  </a>
<a class="sourceLine" id="cb11-9" data-line-number="9">    <span class="op">~</span>id, <span class="op">~</span>symbol,</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">    <span class="st">'id5'</span>, <span class="st">'symbol5'</span>,</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">    <span class="st">'id6'</span>, <span class="st">'symbol6'</span>,</a>
<a class="sourceLine" id="cb11-12" data-line-number="12">    <span class="st">'id4'</span>, <span class="st">'symbol4'</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13">) </a>
<a class="sourceLine" id="cb11-14" data-line-number="14"></a>
<a class="sourceLine" id="cb11-15" data-line-number="15">probe2symbpl &lt;-<span class="st"> </span>probe2id <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(probe, <span class="dt">symbol =</span> id2symbol<span class="op">$</span>symbol[<span class="kw">match</span>(id, id2symbol<span class="op">$</span>id)]) <span class="op">%T&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 3 x 2
  probe  symbol 
  &lt;chr&gt;  &lt;chr&gt;  
1 probe4 symbol4
2 probe5 symbol5
3 probe6 symbol6</code></pre>
<p>In the above code, we map <code>probe</code> to <code>symbol</code> by three steps <a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>.</p>
</div>
<div id="key-difficulty" class="section level2">
<h2>key difficulty</h2>
<p>Back the original problem, you can find that its fairly easy to “replace” <code>'id4'</code> with <code>'symbol4'</code>, <code>'id5'</code> with <code>'symbol5'</code>, etc (thanks to <code>match()</code>). But how can you “replace” the <code>'id1'</code> and <code>'id2'</code> inside <code>'id1 | id2'</code>?</p>
<p>That is what I meet when I want to address a <a href="https://github.com/dongzhuoer/rGEO">biological question</a>, as you can see in the 9th line of <code>probe2ensembl</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">probe2ensembl <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">9</span>)</a></code></pre></div>
<pre><code># A tibble: 1 x 2
  ID          Ensembl                                                
  &lt;chr&gt;       &lt;chr&gt;                                                  
1 200082_s_at ENSG00000171863 /// ENSG00000183405 /// ENSG00000213326</code></pre>
<p>If you think it’s a piece of cake, you may have some misunderstanding <a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>.</p>
</div>
<div id="solution" class="section level2">
<h2>solution</h2>
<p>Inspired by <a href="https://github.com/hadley/reshape"><strong>reshape2</strong></a>, I choose to “melt”</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">probe2id_wide &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tribble</span>(  </a>
<a class="sourceLine" id="cb17-2" data-line-number="2">    <span class="op">~</span>probe, <span class="op">~</span>id,</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">    <span class="st">'probe1'</span>, <span class="st">'id1 | id2'</span>,</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">    <span class="st">'probe2'</span>, <span class="st">'id3'</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">)</a></code></pre></div>
<p>to</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">probe2id_long &lt;-<span class="st"> </span>probe2id_wide <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">melt_map</span>(<span class="st">'probe'</span>, <span class="st">'id'</span>, <span class="st">' </span><span class="ch">\\</span><span class="st">| '</span>) <span class="op">%T&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 3 x 2
  probe  id   
  &lt;chr&gt;  &lt;chr&gt;
1 probe1 id1  
2 probe1 id2  
3 probe2 id3  </code></pre>
<p>I call the former “wide” map and the latter “long” map.</p>
<p>Then use the code in <a href="#solve-a-simpler-one">simpler problem</a> to map id to symbol</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">id2symbol &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tribble</span>(  </a>
<a class="sourceLine" id="cb20-2" data-line-number="2">    <span class="op">~</span>id, <span class="op">~</span>symbol,</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">    <span class="st">'id1'</span>, <span class="st">'symbol1'</span>,</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">    <span class="st">'id2'</span>, <span class="st">'symbol2'</span>,</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">    <span class="st">'id3'</span>, <span class="st">'symbol3'</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6">) </a>
<a class="sourceLine" id="cb20-7" data-line-number="7"></a>
<a class="sourceLine" id="cb20-8" data-line-number="8">probe2symbol_long &lt;-<span class="st"> </span>probe2id_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(probe, <span class="dt">symbol =</span> id2symbol<span class="op">$</span>symbol[<span class="kw">match</span>(id, id2symbol<span class="op">$</span>id)]) <span class="op">%T&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 3 x 2
  probe  symbol 
  &lt;chr&gt;  &lt;chr&gt;  
1 probe1 symbol1
2 probe1 symbol2
3 probe2 symbol3</code></pre>
<p>Finally “cast” to</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">probe2symbol_wide &lt;-<span class="st"> </span>probe2symbol_long <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cast_map</span>(<span class="st">'probe'</span>, <span class="st">'symbol'</span>, <span class="st">' /// '</span>) <span class="op">%T&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 2 x 2
  probe  symbol             
  &lt;chr&gt;  &lt;chr&gt;              
1 probe1 symbol1 /// symbol2
2 probe2 symbol3            </code></pre>
<p>In short, A-B wide map -&gt; A-B long map -&gt; A-C long map -&gt; A-C wide map.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>how to create the <code>probe2ensembl</code> variable</p>
<p>You can copy the following code:</p>
<pre><code>tribble(
  ~ID,           ~Ensembl,                                                 
  &quot;200064_at&quot;,   &quot;ENSG00000096384&quot;,                                        
  &quot;200066_at&quot;,   &quot;ENSG00000113141&quot;,                                        
  &quot;200068_s_at&quot;, &quot;ENSG00000127022&quot;,                                        
  &quot;200069_at&quot;,   &quot;ENSG00000075856&quot;,                                        
  &quot;200071_at&quot;,   &quot;ENSG00000119953&quot;,                                        
  &quot;200076_s_at&quot;, &quot;ENSG00000105700&quot;,                                        
  &quot;200077_s_at&quot;, &quot;ENSG00000104904&quot;,                                        
  &quot;200078_s_at&quot;, &quot;ENSG00000117410&quot;,                                        
  &quot;200082_s_at&quot;, &quot;ENSG00000171863 /// ENSG00000183405 /// ENSG00000213326&quot;,
  &quot;200084_at&quot;,   &quot;ENSG00000110696&quot;
)</code></pre>
<p>Or create it from scratch:</p>
<ol style="list-style-type: decimal">
<li><p>read probe annotation from a GSE SOFT file</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">soft.table &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">'extdata/GSE19161_family.soft.gz'</span>, <span class="dt">package =</span> <span class="st">'rGEO'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">    </span>rGEO<span class="op">::</span><span class="kw">parse_gse_soft</span>(<span class="dt">verbose =</span> F) <span class="op">%&gt;%</span><span class="st"> </span>{.<span class="op">$</span>table} <span class="op">%T&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 658 x 11
   ID          `Species Scientific Nam… `Sequence Type`   `Sequence Sourc…
   &lt;chr&gt;       &lt;chr&gt;                    &lt;chr&gt;             &lt;chr&gt;           
 1 121_at      Homo sapiens             Exemplar sequence GenBank         
 2 200003_s_at Homo sapiens             Exemplar sequence GenBank         
 3 200004_at   Homo sapiens             Exemplar sequence GenBank         
 4 200006_at   Homo sapiens             Exemplar sequence GenBank         
 5 200009_at   Homo sapiens             Exemplar sequence GenBank         
 6 200010_at   Homo sapiens             Exemplar sequence GenBank         
 7 200012_x_at Homo sapiens             Exemplar sequence GenBank         
 8 200016_x_at Homo sapiens             Exemplar sequence GenBank         
 9 200017_at   Homo sapiens             Exemplar sequence GenBank         
10 200018_at   Homo sapiens             Exemplar sequence GenBank         
# ... with 648 more rows, and 7 more variables: `Transcript ID(Array
#   Design)` &lt;chr&gt;, `UniGene ID` &lt;chr&gt;, `Gene Title` &lt;chr&gt;, `Gene
#   Symbol` &lt;chr&gt;, Ensembl &lt;chr&gt;, ORF &lt;chr&gt;, SPOT_ID &lt;chr&gt;</code></pre></li>
<li><p>subset part of the table for the purpose of demostration</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">probe2ensembl &lt;-<span class="st"> </span>soft.table <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span>, <span class="dv">9</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">41</span><span class="op">:</span><span class="dv">50</span>) <span class="op">%T&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 10 x 2
   ID          Ensembl                                                
   &lt;chr&gt;       &lt;chr&gt;                                                  
 1 200064_at   ENSG00000096384                                        
 2 200066_at   ENSG00000113141                                        
 3 200068_s_at ENSG00000127022                                        
 4 200069_at   ENSG00000075856                                        
 5 200071_at   ENSG00000119953                                        
 6 200076_s_at ENSG00000105700                                        
 7 200077_s_at ENSG00000104904                                        
 8 200078_s_at ENSG00000117410                                        
 9 200082_s_at ENSG00000171863 /// ENSG00000183405 /// ENSG00000213326
10 200084_at   ENSG00000110696                                        </code></pre></li>
</ol>
<a href="#fnref1" class="footnote-back">↩</a></li>
<li id="fn2"><p>Ensembl IDs which don’t have corresponding HUGO symbol are discarded.<a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>I deliberately shuffle the rows of <code>id2symbol</code> to show that <code>id2symbol</code> just need to provide the correct relationship between <code>id</code> and <code>symbol</code>, i.e, it doesn’t necessarily maintain the same order as <code>probe2id</code>.<a href="#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>In general:</p>
<ol style="list-style-type: decimal">
<li><code>dplyr::transmute</code> preserves <code>probe2id$probe</code> - <code>probe2id$id</code> relationship by <em>position</em></li>
<li><code>match()</code> finds <code>probe2id$id</code> - <code>id2symbol$id</code> relationship by <em>value</em></li>
<li><code>[]</code> finds <code>id2symbol$id</code> - <code>id2symbol$symbol</code> relationship by <em>position</em></li>
</ol>
<p>Let’s us experience this by an example of <code>'probe4'</code> to <code>'symbol4'</code>:</p>
<ol style="list-style-type: decimal">
<li><p>1st element of <code>probe2id$probe</code> -&gt; 1st element of <code>probe2id$id</code>:<br />
<code>'probe4'</code> is the 1st element of <code>probe2id$probe</code>, so we look for the 1st element of <code>probe2id$id</code>, <code>'id4'</code>.</p></li>
<li><p><code>'id4'</code> in <code>probe2id$id</code> -&gt; <code>'id4'</code> in <code>id2symbol$id</code>:<br />
<code>'id4'</code> is the 1st element of <code>probe2id$id</code>, then we look for the 1st element of <code>match()</code> (which gives the position of <code>probe2id$id</code> in <code>id2symbol$id</code> — <code>c(3, 1, 2)</code> in this case). We get <code>3</code>, so we look for the 3rd element of <code>id2symbol$id</code>, the exact value of <code>'id4'</code>.</p></li>
<li><p>3rd element of <code>id2symbol$id</code> -&gt; 3rd element of <code>id2symbol$symbol</code>:<br />
finally, <code>'id4'</code> is the 3rd element of `<code>id2symbol$id</code>, thus we look for the 3rd element of <code>id2symbol$symbol</code>, <code>'symbol4'</code>.</p></li>
</ol>
<a href="#fnref4" class="footnote-back">↩</a></li>
<li id="fn5"><ul>
<li><p>Computer is very foolish, it can’t convert <code>'id1 | id2'</code> to <code>'symbol1 | symbol2'</code> as you can easily achieve even without thinking. In programming, the only way is to search <code>'id1'</code> in <code>'id1 | id2'</code> and replace with <code>'symbol'</code> if it find one, then search <code>'id2'</code>, <code>'id3'</code>, etc. This will cause a severe poor performance.</p></li>
<li><p>As for replacing all <code>'id'</code> with <code>'symbol'</code>, I use <code>id2symbol</code> just to simplify the problem, the id-symbol map in the real world is usually something like:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">hgnc<span class="op">::</span>ensembl2symbol <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">sample_n</span>(<span class="dv">10</span>)</a></code></pre></div>
<pre><code># A tibble: 10 x 2
   ensembl         symbol   
   &lt;chr&gt;           &lt;chr&gt;    
 1 ENSG00000231701 BMS1P13  
 2 ENSG00000227584 MTND4P5  
 3 ENSG00000251003 ZFPM2-AS1
 4 ENSG00000100565 LRRC74A  
 5 ENSG00000249997 MTCO3P7  
 6 ENSG00000252161 RNA5SP318
 7 ENSG00000244476 ERVFRD-1 
 8 ENSG00000125633 CCDC93   
 9 ENSG00000222496 RN7SKP200
10 ENSG00000199845 RNA5SP375</code></pre></li>
</ul>
<a href="#fnref5" class="footnote-back">↩</a></li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
